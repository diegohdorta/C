<!doctype html>
<html>

<head>

  <title>
    
      Getting Started with i.MX8 Source Code | chronicles in coding
    
  </title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <!-- Use Atom -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/rss-feed.xml" title="chronicles in coding" />
  <!-- Use RSS-2.0 -->
  <!--<link href="/rss-feed.xml" type="application/rss+xml" rel="alternate" title="chronicles in coding | blog inspired by true events on movie screens, unix and related stuff"/>
  //-->

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quattrocento+Sans">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117915917-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117915917-3');
</script>



  <!-- Use Jekyll SEO plugin -->
  <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Getting Started with i.MX8 Source Code | chronicles in coding</title>
<meta name="generator" content="Jekyll v3.6.2" />
<meta property="og:title" content="Getting Started with i.MX8 Source Code" />
<meta name="author" content="Diego Dorta" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post provides a step-by-step guide to users interested to build U-Boot and Linux Kernel for i.MX8 SoC boards manually, just using their source codes. The approaching ones are i.MX8QM LPDDR4 ARM2, and i.MX8MQ EVK Board. The tutorial also demonstrate how to integrate them with a rootfs generated by the Yocto Project. The Kernel, and rootfs procedure are the same for all boards, however U-Boot requires a different approach for each SoC, all detailed at U-Boot step. To create a full image, choose a U-Boot step, then follow the Kernel and rootfs steps:" />
<meta property="og:description" content="This post provides a step-by-step guide to users interested to build U-Boot and Linux Kernel for i.MX8 SoC boards manually, just using their source codes. The approaching ones are i.MX8QM LPDDR4 ARM2, and i.MX8MQ EVK Board. The tutorial also demonstrate how to integrate them with a rootfs generated by the Yocto Project. The Kernel, and rootfs procedure are the same for all boards, however U-Boot requires a different approach for each SoC, all detailed at U-Boot step. To create a full image, choose a U-Boot step, then follow the Kernel and rootfs steps:" />
<link rel="canonical" href="http://localhost:4000/tutorial/Getting-Started-iMX8-Source-Code.html" />
<meta property="og:url" content="http://localhost:4000/tutorial/Getting-Started-iMX8-Source-Code.html" />
<meta property="og:site_name" content="chronicles in coding" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-12-18T00:00:00-02:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/tutorial/Getting-Started-iMX8-Source-Code.html","headline":"Getting Started with i.MX8 Source Code","dateModified":"2017-12-18T00:00:00-02:00","datePublished":"2017-12-18T00:00:00-02:00","author":{"@type":"Person","name":"Diego Dorta"},"description":"This post provides a step-by-step guide to users interested to build U-Boot and Linux Kernel for i.MX8 SoC boards manually, just using their source codes. The approaching ones are i.MX8QM LPDDR4 ARM2, and i.MX8MQ EVK Board. The tutorial also demonstrate how to integrate them with a rootfs generated by the Yocto Project. The Kernel, and rootfs procedure are the same for all boards, however U-Boot requires a different approach for each SoC, all detailed at U-Boot step. To create a full image, choose a U-Boot step, then follow the Kernel and rootfs steps:","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/tutorial/Getting-Started-iMX8-Source-Code.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


<body>

  <div class="container">
    <header class="masthead">
  <h3 class="masthead-title">
    <a href="/">chronicles in coding</a>
    <small class="masthead-subtitle">blog inspired by true events on movie screens, unix and related stuff</small>
    <div class="menu">
  <nav class="menu-content">
    
      <a href="/menu/about.html">About</a>
    
      <a href="/menu/writing.html">Writing</a>
    
      <a href="/menu/contact.html">Contact</a>
    
  </nav>
  <nav class="social-icons">
    
  
  
    <a href="https://www.github.com/diegohdorta" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.linkedin.com/in/diego-dorta-059465131/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
  

  
  
    <a href="mailto:diego.dorta@nxp.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.instagram.com/diegohdorta/" target="_blank"><i class="fa fa-instagram" aria-hidden="true"></i></a>
  

  
  
    <a href="spotify:user:diegohdorta:playlist:25pUm8SDTIPBRFdB8QbXmv" target="_blank"><i class="fa fa-spotify" aria-hidden="true"></i></a>
  

  
  
    <a href="rss-feed.xml" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
  

  </nav>
</div>

  </h3>
</header>


    <div class="post-container">
      <h1>
  Getting Started with i.MX8 Source Code
</h1>



<p>This post provides a step-by-step guide to users interested to build <em>U-Boot</em> and <em>Linux Kernel</em> for i.MX8 SoC boards manually, just using their source codes.
The approaching ones are <code class="highlighter-rouge">i.MX8QM LPDDR4 ARM2</code>, and <code class="highlighter-rouge">i.MX8MQ EVK Board</code>. The tutorial also demonstrate how to integrate them with a <em>rootfs</em> generated by the <code class="highlighter-rouge">Yocto Project</code>.
The <em>Kernel</em>, and <em>rootfs</em> procedure are the same for all boards, however <em>U-Boot</em> requires a different approach for each <em>SoC</em>, all detailed at <em>U-Boot</em> step.
To create a full image, choose a <em>U-Boot</em> step, then follow the <em>Kernel</em> and <em>rootfs</em> steps:</p>

<p><em>Some steps may not work completely due the constant maintenance.</em></p>

<h1 id="installing-toolchain">Installing Toolchain</h1>

<p>A <code class="highlighter-rouge">cross compiler</code> is required to compile the source codes. This guide was tested with both
cross compiler packages <code class="highlighter-rouge">Yocto</code> or <code class="highlighter-rouge">Linux</code>:</p>

<h4 id="toolchain-provide-by-yocto">Toolchain provide by Yocto</h4>

<p>Get the download <a href="http://shlinux12.ap.freescale.net/Yocto_SDK/4.9.x-1.0.0-GCC6.2/aarch64/"><code class="highlighter-rouge">here</code></a>. Then, change the permission to execute, you may need <code class="highlighter-rouge">root privileges</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>chmod +x fsl-imx-internal-xwayland-glibc-x86_64-fsl-image-gui-aarch64-toolchain-4.9.51-mx8-beta.sh
</code></pre></div></div>
<p>Install and apply <code class="highlighter-rouge">yes</code> for all:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./fsl-imx-internal-xwayland-glibc-x86_64-fsl-image-gui-aarch64-toolchain-4.9.51-mx8-beta.sh 
</code></pre></div></div>

<p>Export the <code class="highlighter-rouge">toolchain</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">source</span> /opt/fsl-imx-internal-xwayland/4.9.51-mx8-beta/environment-setup-aarch64-poky-linux
</code></pre></div></div>

<h4 id="toolchain-provide-by-linux">Toolchain provide by Linux</h4>

<p>Install the Ubuntu toolchain <code class="highlighter-rouge">gcc-aarch64-linux-gnu</code> GNU C compiler for the <code class="highlighter-rouge">arm64</code> architecture:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>apt-get install gcc-aarch64-linux-gnu
</code></pre></div></div>
<p>Export the environment variables:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<span class="nv">$ </span><span class="nb">export </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>/usr/bin/aarch64-linux-gnu-
</code></pre></div></div>
<h2 id="u-boot">U-Boot</h2>

<h3 id="u-boot-for-imx8qm-lpddr4-arm2">U-Boot for i.MX8QM LPDDR4 ARM2</h3>

<h4 id="mkimage-step">Mkimage Step</h4>

<p>Create a folder for organize the files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mkdir mx8 <span class="o">&amp;&amp;</span> <span class="nb">cd </span>mx8/
</code></pre></div></div>
<p>Download of mkimage:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://bitbucket.sw.nxp.com/scm/imx/imx-mkimage.git
<span class="nv">$ </span><span class="nb">cd </span>imx-mkimage/
<span class="nv">$ </span>git checkout imx_4.9.51_imx8_beta1
</code></pre></div></div>
<pre><code class="language-NOTE">Commit ID: e131af1031fff50106777c2338c41bf58c0b86a1
</code></pre>
<p>After downloading, follow the next steps.</p>

<h4 id="u-boot-step">U-Boot Step</h4>

<p>Download the <em>U-Boot</em> from:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://bitbucket.sw.nxp.com/scm/imx/uboot-imx.git
<span class="nv">$ </span><span class="nb">cd </span>uboot-imx/
<span class="nv">$ </span>git checkout imx_v2017.03_4.9.51_imx8_beta1
</code></pre></div></div>
<pre><code class="language-NOTE">Commit ID: c8e6eb2179512ee87c8faa08bbe826ead40ab702
</code></pre>
<p>Compile the <em>U-Boot</em>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">unset </span>LDFLAGS
<span class="nv">$ </span>make <span class="nt">-j8</span> <span class="nv">CC</span><span class="o">=</span><span class="s2">"</span><span class="nv">$CC</span><span class="s2">"</span> imx8qm_lpddr4_arm2_defconfig
<span class="nv">$ </span>make <span class="nt">-j8</span> <span class="nv">CC</span><span class="o">=</span><span class="s2">"</span><span class="nv">$CC</span><span class="s2">"</span>
</code></pre></div></div>
<p>The <code class="highlighter-rouge">u-boot.bin</code> file will be created. Copy it to mkimage <code class="highlighter-rouge">iMX8QM folder</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cp u-boot.bin ../imx-mkimage/iMX8QM/
</code></pre></div></div>

<pre><code class="language-IMPORTANT">Use *unset LDFLAGS* if the Yocto toolchain is used.
</code></pre>

<h4 id="atf-arm-trust-firmware-step">ATF (Arm Trust Firmware) Step</h4>

<p>Get the download of <code class="highlighter-rouge">Arm Trust Firmware</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://bitbucket.sw.nxp.com/scm/imx/arm-trusted-firmware.git
</code></pre></div></div>
<p>Compile the <code class="highlighter-rouge">ATF</code> by doing:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>make <span class="nv">PLAT</span><span class="o">=</span>imx8qm bl31
</code></pre></div></div>
<p>This builds <code class="highlighter-rouge">bl31.bin</code> file on: <em>build/imx8qm/release/bl31.bin</em>.</p>

<p>Copy the <code class="highlighter-rouge">bl31.bin</code> inside mkimage <code class="highlighter-rouge">iMX8QM folder</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cp build/imx8mq/release/bl31.bin ../imx-mkimage/iMX8QM/
</code></pre></div></div>
<h4 id="sc-firmware-step">SC Firmware Step</h4>

<p><em>This section needs improvements. Currently it is not possible to compile the firmware the pre-built firmware is used instead.</em></p>

<p>Get the firmware from downloading the <a href="https://www.nxp.com/webapp/Download?colCode=L4.9.11_IMX8QM_SOURCE_Alpha&amp;appType=license&amp;Parent_nodeId=1454108179417712493862&amp;Parent_pageType=product"><code class="highlighter-rouge">NXP Alpha release</code></a>.
Copy the <code class="highlighter-rouge">imx-sc-firmware-0.1.bin</code> to mx8 folder, then:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>chmod +x imx-sc-firmware-0.1.bin
<span class="nv">$ </span>./imx-sc-firmware-0.1.bin
</code></pre></div></div>
<p>Copy the <code class="highlighter-rouge">firmware</code> into mkimage iMX8QM folder:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cp imx-sc-firmware-0.1/mx8qm-scfw-tcm.bin ../imx-mkimage/iMX8QM/
</code></pre></div></div>
<p>Then, rename the firmware to ‘scfw_tcm.bin’:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>imx-mkimage/iMX8QM/
<span class="nv">$ </span>mv mx8qm-scfw-tcm.bin scfw_tcm.bin
</code></pre></div></div>
<h4 id="gathering-step">Gathering Step</h4>

<p>Check the files: <code class="highlighter-rouge">bl31.bin</code>, <code class="highlighter-rouge">scfm_tcm.bin</code>, <code class="highlighter-rouge">u-boot.bin</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>imx-mkimage/
<span class="nv">$ </span>tree iMX8QM/
├── bl31.bin
├── expand_c_define.sh
├── head.hash
├── imx8qm_dcd_1.6GHz.cfg
├── imx8qm_dcd_800MHz.cfg
├── imx8qm_dcd.cfg
├── lib
│
├── ddrc_mem_map.h
│
└── ddr_phy_mem_map.h
├── scfw_tcm.bin
├── soc.mak
├── u-boot-atf.bin
├── u-boot.bin
└── u-boot-hash.bin
1 directory, 14 files
</code></pre></div></div>
<p><em>Open a new terminal to generate flash.bin file.</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>imx-mkimage/
<span class="nv">$ </span>make clean
<span class="nv">$ </span>make <span class="nv">SOC</span><span class="o">=</span>iMX8QM flash
</code></pre></div></div>
<h4 id="flashing-step">Flashing Step</h4>

<p>Typical flash cmd:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dd <span class="k">if</span><span class="o">=</span>iMX8QM/flash.bin <span class="nv">of</span><span class="o">=</span>/dev/&lt;your device&gt; <span class="nv">bs</span><span class="o">=</span>1k <span class="nv">seek</span><span class="o">=</span>33 <span class="nv">status</span><span class="o">=</span>progress <span class="o">&amp;&amp;</span> sync
</code></pre></div></div>

<h3 id="u-boot-for-imx8mq-evk-board">U-Boot for i.MX8MQ EVK Board</h3>

<h4 id="mkimage-step-1">Mkimage Step</h4>

<p>Create a folder for organize the files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mkdir mx8 <span class="o">&amp;&amp;</span> <span class="nb">cd </span>mx8/
</code></pre></div></div>
<p>Download of mkimage:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://bitbucket.sw.nxp.com/scm/imx/imx-mkimage.git
<span class="nv">$ </span><span class="nb">cd </span>imx-mkimage/
<span class="nv">$ </span>git checkout imx_4.9.51_imx8_beta1
</code></pre></div></div>
<pre><code class="language-NOTE">Commit ID: e131af1031fff50106777c2338c41bf58c0b86a1
</code></pre>
<p>After downloading, follow the next steps.</p>

<h4 id="u-boot-step-1">U-Boot Step</h4>

<p>Download the U-Boot from:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://bitbucket.sw.nxp.com/scm/imx/uboot-imx.git
<span class="nv">$ </span><span class="nb">cd </span>uboot-imx/
<span class="nv">$ </span>git checkout imx_v2017.03_4.9.51_imx8_beta1
</code></pre></div></div>
<pre><code class="language-NOTE">Commit ID: c8e6eb2179512ee87c8faa08bbe826ead40ab702
</code></pre>
<p>To compile the <em>U-Boot</em>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">unset </span>LDFLAGS
<span class="nv">$ </span>make <span class="nt">-j8</span> imx8mq_evk_defconfig
<span class="nv">$ </span>make <span class="nt">-j8</span>
</code></pre></div></div>
<p>Copy the <code class="highlighter-rouge">u-boot.bin</code>, <code class="highlighter-rouge">u-boot-spl.bin</code>, <code class="highlighter-rouge">u-boot-nodtb.bin</code>, <code class="highlighter-rouge">fsl-imx8mq-evk.dtb</code> to the mkimage iMX8QM folder:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cp spl/u-boot-spl.bin ../imx-mkimage/iMX8M/
<span class="nv">$ </span>cp u-boot.bin ../imx-mkimage/iMX8M/
<span class="nv">$ </span>cp u-boot-nodtb.bin ../imx-mkimage/iMX8M/
<span class="nv">$ </span>cp arch/arm/dts/fsl-imx8mq-evk.dtb ../imx-mkimage/iMX8M/
</code></pre></div></div>

<pre><code class="language-NOTE">Use *unset LDFLAGS* if the Yocto toolchain is used.
</code></pre>
<h4 id="atf-arm-trust-firmware-step-1">ATF (Arm Trust Firmware) Step</h4>

<p>Download the ATF from:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://bitbucket.sw.nxp.com/scm/imx/arm-trusted-firmware.git
<span class="nv">$ </span><span class="nb">cd </span>arm-trusted-firmware/
<span class="nv">$ </span>git checkout imx_4.9.51_imx8_beta1
</code></pre></div></div>
<pre><code class="language-NOTE">Commit ID: a4388010f06ceb8fa9a33391bff47dabd027dbb1
</code></pre>
<p>Compile the ATF by running:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>make <span class="nv">PLAT</span><span class="o">=</span>imx8mq bl31
</code></pre></div></div>
<p>This builds <code class="highlighter-rouge">bl31.bin</code> file on: <em>build/imx8mq/release/bl31.bin</em>.</p>

<p>Copy the <code class="highlighter-rouge">bl31.bin</code> to the mkimage iMX8M folder:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cp build/imx8mq/release/bl31.bin ../imx-mkimage/iMX8M/
</code></pre></div></div>

<h4 id="sc-firmware-step-1">SC Firmware Step</h4>

<p><em>This section needs improvements. Currently it is not possible to compile the firmware the pre-built firmware is used instead.</em></p>

<p>Download the file <a href="http://yb2.am.freescale.net/build-output/Linux_IMX_MX8_BETA/79/build_log/imx_rc_archive/external-mirror/"><code class="highlighter-rouge">imx-4.9.51-mx8qm_beta1-external-mirror_2017-11-29.tar.gz</code></a>. Then, follow the steps:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xf</span> imx-4.9.51-mx8qm_beta1-external-mirror_2017-11-29.tar.gz
<span class="nv">$ </span>chmod +x firmware-imx-7.1.bin
<span class="nv">$ </span>./firmware-imx-7.1.bin
</code></pre></div></div>
<p>Copy the files to the mkimage iMX8M folder:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>firmware-imx-7.1.bin/
<span class="nv">$ </span>cp firmware/hdmi/cadence/hdmi_imx8m.bin ../imx-mkimage/iMX8M/
<span class="nv">$ </span>cp firmware/ddr/synopsys/lpddr4_pmu_train_<span class="k">*</span> ../imx-mkimage/iMX8M/
</code></pre></div></div>
<h4 id="gathering-step-1">Gathering Step</h4>

<p>Check the files: <code class="highlighter-rouge">bl31.bin</code>, <code class="highlighter-rouge">fsl-imx8mq-evk.dtb</code>, <code class="highlighter-rouge">hdmi_imx8m.bin</code>, <code class="highlighter-rouge">u-boot.bin</code>, <code class="highlighter-rouge">u-boot-nodtb.bin</code>, <code class="highlighter-rouge">u-boot-spl.bin</code>, <code class="highlighter-rouge">lpddr4_pmu_train_dmem.bin</code>, <code class="highlighter-rouge">lpddr4_pmu_train_imem.bin</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>imx-mkimage/
<span class="nv">$ </span>tree iMX8M/
├── bl31.bin
├── fsl-imx8mq-evk.dtb
├── hdmi_imx8m.bin
├── lib
│
└── ddr_memory_map.h
├── lpddr4_pmu_train_dmem.bin
├── lpddr4_pmu_train_imem.bin
├── mkimage_imx8.c
├── README
├── soc.mak
├── u-boot.bin
├── u-boot-nodtb.bin
└── u-boot-spl.bin
1 directory, 12 files
</code></pre></div></div>
<p><em>Open a new terminal to generate flash.bin file.</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>imx-mkimage/
<span class="nv">$ </span>make clean
<span class="nv">$ </span>make <span class="nv">SOC</span><span class="o">=</span>iMX8M flash_spl_uboot
</code></pre></div></div>
<h4 id="flashing-step-1">Flashing Step</h4>

<p>Typical flash cmd:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dd <span class="k">if</span><span class="o">=</span>iMX8M/flash.bin <span class="nv">of</span><span class="o">=</span>/dev/&lt;your device&gt; <span class="nv">bs</span><span class="o">=</span>1k <span class="nv">seek</span><span class="o">=</span>33 <span class="nv">status</span><span class="o">=</span>progress <span class="o">&amp;&amp;</span> sync
</code></pre></div></div>
<h2 id="kernel">Kernel</h2>

<p>Download <code class="highlighter-rouge">linux-imx</code> from:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://bitbucket.sw.nxp.com/scm/imx/linux-imx.git
<span class="nv">$ </span><span class="nb">cd </span>linux-imx/
<span class="nv">$ </span>git checkout imx_4.9.51_imx8_beta1
</code></pre></div></div>
<p><strong>Export</strong> one of the toolchain <code class="highlighter-rouge">Yocto</code> or <code class="highlighter-rouge">Linux</code>. Then:</p>

<h3 id="compiling">Compiling</h3>

<p>Compile the <em>Kernel</em>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>make <span class="nv">ARCH</span><span class="o">=</span>arm64 defconfig
<span class="nv">$ </span>make <span class="nt">-j8</span> <span class="nv">ARCH</span><span class="o">=</span>arm64
</code></pre></div></div>
<p>Copy the Image file and dtb into your SD card:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cp arch/arm64/boot/Image /media/<span class="k">${</span><span class="nv">USER</span><span class="k">}</span>/Boot
<span class="nv">$ </span>cp arch/arm64/boot/dts/freescale/&lt;dtb_file&gt;.dtb /media/<span class="k">${</span><span class="nv">USER</span><span class="k">}</span>/Boot
</code></pre></div></div>
<h2 id="root-file-system">Root File System</h2>

<p>A quick alternative to deploy a <code class="highlighter-rouge">rootfs</code> is to use a <code class="highlighter-rouge">pre-built</code> system, download it from <a href="http://yb2.am.freescale.net/build-output/Linux_IMX_MX8_BETA/79/fsl-imx-xwayland/">here</a>.</p>

<p>Uncompress the file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bunzip2 &lt;image&gt;.rootfs.tar.bz2
<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xf</span> &lt;image&gt;.rootfs.tar <span class="nt">-C</span> /media/<span class="k">${</span><span class="nv">USER</span><span class="k">}</span>/rootfs
</code></pre></div></div>

<h2 id="building-rfs-with-yocto">Building RFS with Yocto</h2>

<p>To get the BSP you need to have repo utility installed (<em>only need to do this once</em>):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mkdir ~/bin
<span class="nv">$ </span>curl http://commondatastorage.googleapis.com/git-repo-downloads/repo <span class="o">&gt;</span> ~/bin/repo
<span class="nv">$ </span>chmod a+x ~/bin/repo
<span class="nv">$ PATH</span><span class="o">=</span><span class="k">${</span><span class="nv">PATH</span><span class="k">}</span>:~/bin
</code></pre></div></div>
<h3 id="imx8qm-lpddr4-arm2">i.MX8QM LPDDR4 ARM2</h3>

<p>Download the <code class="highlighter-rouge">Yocto Project Environment</code> into your directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mkdir fsl-arm-yocto-bsp
<span class="nv">$ </span><span class="nb">cd </span>fsl-arm-yocto-bsp
<span class="nv">$ </span>repo init <span class="nt">-u</span> https://source.codeaurora.org/external/imx/imx-manifest <span class="nt">-b</span> imx-linux-morty <span class="nt">-m</span> imx-4.9.51-8qm_beta1.xml
<span class="nv">$ </span>repo sync
</code></pre></div></div>
<p>The configuration for i.MX8QM LPDDR4 ARM2 is detailed below:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ MACHINE</span><span class="o">=</span>imx8qmlpddr4arm2 <span class="nv">DISTRO</span><span class="o">=</span>fsl-imx-wayland <span class="nb">source</span> ./fsl-setup-release.sh <span class="nt">-b</span> bld-wayland
</code></pre></div></div>
<p>Just run the following command for creating the image (this may take a while):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bitbake core-image-minimal
</code></pre></div></div>
<p>After this step is completed, flash the image into the SD card:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>tmp/deploy/images/imx8qmlpddr4arm2/
<span class="nv">$ </span>dd <span class="k">if</span><span class="o">=</span>core-image-minimal-imx8qmlpddr4arm2-20171212175528.rootfs.sdcard <span class="nv">of</span><span class="o">=</span>/dev/&lt;your_device&gt; <span class="nv">status</span><span class="o">=</span>progress <span class="o">&amp;&amp;</span> sync
</code></pre></div></div>
<p><em>Other boards will need to wait for a few months.</em></p>

<p>Download PDF file from <a href="http://localhost:4000/assets/pdf/Getting_Started_Source_Code_iMX8_v0.3.pdf">here</a>.</p>


<span class="post-date">
  Written on
  
  December
  18th,
  2017
  by
  
    Diego Dorta
  
</span>

<div class="post-date">Feel free to share!</div>
  <div class="sharing-icons">
    <a href="https://twitter.com/intent/tweet?text=Getting Started with i.MX8 Source Code&amp;url=/tutorial/Getting-Started-iMX8-Source-Code.html" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=/tutorial/Getting-Started-iMX8-Source-Code.html&amp;title=Getting Started with i.MX8 Source Code" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
    <a href="https://plus.google.com/share?url=/tutorial/Getting-Started-iMX8-Source-Code.html" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
  </div>
</div>


<div class="related">
  <h1 >You may also enjoy:</h1>
  
  <ul class="related-posts">
    
      
        
          <li>
            <h3>
              <a href="/tutorial/Building-UBoot-for-iMX8QXP.html">
                Building U-Boot for iMX8 QXP Board
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>July 17, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
          <li>
            <h3>
              <a href="/yocto/Seeting-Up-Yocto-for-iMX-BSP-releases.html">
                Setting up Yocto for i.MX BSP releases
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>July 16, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
        
      
    
      
        
        
      
        
          <li>
            <h3>
              <a href="/artificial/Installing-Libraries-ML.html">
                Machine Learning Libraries for iMX
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>March 21, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
        
      
    
      
        
          <li>
            <h3>
              <a href="/artificial/Python-Course-301.html">
                Python Course 301
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>November 8, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
          <li>
            <h3>
              <a href="/artificial/Python-Course-201.html">
                Python Course 201
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>November 8, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
          <li>
            <h3>
              <a href="/artificial/Python-Course-101.html">
                Python Course 101
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>November 8, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
    
      
        
        
      
        
        
      
        
          <li>
            <h3>
              <a href="/tutorial/How_to_decrease_boot_time_on_iMX6.html">
                Decreasing Boot Time on i.MX6
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>October 19, 2016</small>-->
              </a>
            </h3>
          </li>
          
        
      
    
      
        
        
      
    
      
        
        
      
    
  </ul>
</div>



  <section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = "dorta";
    var disqus_identifier = "/tutorial/Getting-Started-iMX8-Source-Code.html";
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



    </div>

    <footer class="footer">
  
  
  
    <a href="https://www.github.com/diegohdorta" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.linkedin.com/in/diego-dorta-059465131/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
  

  
  
    <a href="mailto:diego.dorta@nxp.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.instagram.com/diegohdorta/" target="_blank"><i class="fa fa-instagram" aria-hidden="true"></i></a>
  

  
  
    <a href="spotify:user:diegohdorta:playlist:25pUm8SDTIPBRFdB8QbXmv" target="_blank"><i class="fa fa-spotify" aria-hidden="true"></i></a>
  

  
  
    <a href="rss-feed.xml" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
  

  <div class="post-date"><a href="/menu/about.html">chronicles in coding | blog inspired by true events on movie screens, unix and related stuff by Diego Dorta</a></div>
</footer>

  </div>

</body>
</html>
